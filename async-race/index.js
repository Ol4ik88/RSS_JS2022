(()=>{"use strict";var t,e,n,a,s={647:(t,e,n)=>{n.d(e,{AV:()=>b,Ag:()=>w,BS:()=>p,Bo:()=>u,DT:()=>d,Rn:()=>c,ix:()=>y,oX:()=>i,p6:()=>m,tD:()=>l,yQ:()=>h});const a="http://127.0.0.1:3000",s=`${a}/garage`,o=`${a}/engine`,r=`${a}/winners`,c=async(t,e=7)=>{const n=await fetch(`${s}?_page=${t}&_limit=${e}`);return{items:await n.json(),count:n.headers.get("X-Total-Count")}},i=async t=>(await fetch(`${s}/${t}`)).json(),d=async t=>(await fetch(s,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json(),l=async t=>(await fetch(`${s}/${t}`,{method:"DELETE"})).json(),u=async(t,e)=>(await fetch(`${s}/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json(),m=async t=>(await fetch(`${o}?id=${t}&status=started`,{method:"PATCH"})).json(),h=async t=>(await fetch(`${o}?id=${t}&status=stopped`,{method:"PATCH"})).json(),w=async t=>{const e=await fetch(`${o}?id=${t}&status=drive`,{method:"PATCH"}).catch();return 200!==e.status?{success:!1}:{...await e.json()}},y=async({page:t,limit:e=10,sort:n="",order:a=""})=>{const s=await fetch(`${r}?_page=${t}&_limit=${e}${((t,e)=>t&&e?`&_sort=${t}&_order=${e}`:"")(n,a)}`),o=await s.json();return{items:await Promise.all(o.map((async t=>({...t,car:await i(t.id)})))),count:s.headers.get("X-Total-Count")}},p=async t=>(await fetch(`${r}/${t}`,{method:"DELETE"})).json(),b=async({id:t,time:e})=>{const n=await(async t=>(await fetch(`${r}/${t}`)).status)(t);if(404===n)await(async t=>(await fetch(r,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json())({id:t,wins:1,time:e});else{const n=await(async t=>(await fetch(`${r}/${t}`)).json())(t);await(async(t,e)=>(await fetch(`${r}/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json())(t,{id:t,wins:n.wins+1,time:e<n.time?e:n.time})}}},182:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{g:()=>m,k:()=>f});var s=n(647),o=n(34),r=n(545),c=n(720),i=n(22),d=t([o,r,c]);[o,r,c]=d.then?(await d)():d;let l=null;const u=7,m=async()=>{const{items:t,count:e}=await(0,s.Rn)(c.h.carsPage);c.h.cars=t,c.h.carsCount=e,(0,o.I)(c.h.carsPage,+c.h.carsCount,u)},h=t=>{const e=t.filter((({success:t})=>!0===t)).reduce(((t,e)=>t.time<e.time?t:e));return{...c.h.cars.find((({id:t})=>t===e.id)),time:+(e.time/1e3).toFixed(2)}},w=async t=>{const e=document.querySelector(`#start-car-${t}`);e.disabled=!0,e.classList.toggle("enabling",!0);const{velocity:n,distance:a}=await(0,s.p6)(t),o=Math.round(a/n);e.classList.toggle("enabling",!1),document.querySelector(`#stop-car-${t}`).disabled=!1;const r=document.querySelector(`#car-${t}`),d=document.querySelector(`#flag-${t}`),l=Math.floor((0,i.Sp)(r,d))+100;c.h.animation[t]=(0,i.oQ)(r,l,o);const{success:u}=await(0,s.Ag)(t);return u||window.cancelAnimationFrame(c.h.animation[t].idAnim),{success:u,id:t,time:o}},y=async t=>{const e=document.querySelector(`#stop-car-${t}`);e.disabled=!0,e.classList.toggle("enabling",!0),await(0,s.yQ)(t),e.classList.toggle("enabling",!1),document.querySelector(`#start-car-${t}`).disabled=!1,document.querySelector(`#car-${t}`).style.transform="translateX(0)",c.h.animation[t]&&window.cancelAnimationFrame(c.h.animation[t].idAnim)},p=()=>{document.querySelector("#create")?.addEventListener("submit",(async t=>{t.preventDefault();const e=document.querySelector("#create-name").value,n=document.querySelector("#create-color").value;await(0,s.DT)({name:e,color:n}),await m(),document.querySelector("#garage").innerHTML=(0,r.O3)(),document.querySelector("#create-name").value="",t.target.disabled=!0}))},b=()=>{document.querySelector("#update")?.addEventListener("submit",(async t=>{t.preventDefault();const e=document.querySelector("#update-name").value,n=document.querySelector("#update-color").value;await(0,s.Bo)(l.id,{name:e,color:n}),await m(),document.querySelector("#garage").innerHTML=(0,r.O3)(),document.querySelector("#update-name").value="",(0,i.SL)(["#update-name","#update-color",".update-submit"],!0),l=null}))},g=()=>{document.querySelector(".race-controls").addEventListener("click",(async t=>{const e=t.target;if(e.classList.contains("generator-button")){e.disabled=!0;const t=(0,i.cj)();await Promise.all(t.map((async t=>await(0,s.DT)(t)))),await m(),document.querySelector("#garage").innerHTML=(0,r.O3)(),e.disabled=!1}if(e.classList.contains("race-button")){e.disabled=!0,(0,i.SL)(["#next","#prev"],!0);const t=await Promise.all(c.h.cars.map((async({id:t})=>await w(t))));(0,o.I)(c.h.carsPage,+c.h.carsCount,u);const n=h(t),a=document.querySelector("#message");a.innerHTML=`${n.name} won, ${n.time}s`,a.classList.toggle("visible",!0),await(0,s.AV)(n),document.querySelector("#reset").disabled=!1}e.classList.contains("reset-button")&&(e.disabled=!0,c.h.cars.map((({id:t})=>y(t))),document.querySelector("#message").classList.toggle("visible",!1),document.querySelector("#race").disabled=!1)}))},v=(t,e,n)=>{t.classList.contains(`${e}-button`)&&n(+t.id.split(`${e}-car-`)[1])},$=()=>{document.querySelector("#garage").addEventListener("click",(async t=>{const e=t.target;if(e.classList.contains("select-button")&&(l=await(0,s.oX)(+e.id.split("select-car-")[1]),document.querySelector("#update-name").value=l.name,document.querySelector("#update-color").value=l.color,(0,i.SL)(["#update-name","#update-color",".update-submit"],!1)),e.classList.contains("remove-button")){const t=+e.id.split("remove-car-")[1];await(0,s.tD)(t),await(0,s.BS)(t),await m(),document.querySelector("#garage").innerHTML=(0,r.O3)()}v(e,"start",w),v(e,"stop",y)}))},f=()=>{g(),$(),p(),b()};a()}catch(t){a(t)}}))},34:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{I:()=>m,o:()=>p});var s=n(182),o=n(545),r=n(720),c=n(902),i=n(22),d=t([s,o,r,c]);[s,o,r,c]=d.then?(await d)():d;const l=7,u=10;function m(t,e,n){document.querySelector("#next").disabled=!(t*n<e),document.querySelector("#prev").disabled=!(t>1)}const h=()=>{document.querySelector(".menu").addEventListener("click",(async t=>{const e=t.target;e.classList.contains("button-view-garage")&&(m(r.h.carsPage,+r.h.carsCount,l),(0,i.rG)(["#garage-view","#winners-view"],["block","none"])),e.classList.contains("button-view-winners")&&((0,i.rG)(["#garage-view","#winners-view"],["none","block"]),await(0,c.k)(),document.querySelector("#winners-view").innerHTML=(0,o.V9)(),m(r.h.winnersPage,+r.h.winnersCount,u))}))},w=async(t,e)=>{if(t.classList.contains(`button-${e}`))switch(r.h.view){case"garage":r.h.carsPage="prev"===e?r.h.carsPage-1:r.h.carsPage+1,await(0,s.g)(),document.querySelector("#garage").innerHTML=(0,o.O3)();break;case"winners":r.h.winnersPage="prev"===e?r.h.winnersPage-1:r.h.winnersPage+1,await(0,c.k)(),document.querySelector("#winners-view").innerHTML=(0,o.V9)()}},y=()=>{document.querySelector(".pagination").addEventListener("click",(async t=>{const e=t.target;w(e,"prev"),w(e,"next")}))},p=()=>{h(),(0,s.k)(),y(),(0,c.p)()};a()}catch(b){a(b)}}))},902:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{k:()=>l,p:()=>m});var s=n(647),o=n(34),r=n(545),c=n(720),i=t([o,r,c]);[o,r,c]=i.then?(await i)():i;const d=10,l=async()=>{const{items:t,count:e}=await(0,s.ix)({page:c.h.winnersPage,sort:c.h.sortBy,order:c.h.sortOrder});c.h.winners=t,c.h.winnersCount=e,(0,o.I)(c.h.winnersPage,+c.h.winnersCount,d)},u=async t=>{c.h.sortOrder="asc"===c.h.sortOrder?"desc":"asc",c.h.sortBy=t,await l(),document.querySelector("#winners-view").innerHTML=(0,r.V9)()},m=()=>{document.querySelector("#winners-view").addEventListener("click",(async t=>{const e=t.target;e.classList.contains("table-wins")&&u("wins"),e.classList.contains("table-time")&&u("time")}))};a()}catch(t){a(t)}}))},545:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{O3:()=>d,V9:()=>l,sY:()=>p});var s=n(720),o=t([s]);s=(o.then?(await o)():o)[0];const r=t=>`\n<?xml version="1.0" encoding="iso-8859-1"?>\n\x3c!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n    width="79.536px" height="79.536px" viewBox="0 0 79.536 79.536" style="enable-background:new 0 0 79.536 79.536;"\n    xml:space="preserve">\n<g>\n  <path style="fill:${t};" d="M15.532,56.706c-3.977,0-7.213-3.242-7.213-7.197c0-3.998,3.236-7.224,7.213-7.224\n    c3.987,0,7.226,3.226,7.226,7.224C22.758,53.463,19.519,56.706,15.532,56.706z M15.532,45.604c-2.128,0-3.876,1.75-3.876,3.883\n    c0,2.129,1.748,3.879,3.876,3.879c2.141,0,3.886-1.75,3.886-3.879C19.418,47.354,17.673,45.604,15.532,45.604z M64.137,56.706\n    c-3.987,0-7.219-3.242-7.219-7.197c0-3.998,3.231-7.224,7.219-7.224c3.977,0,7.208,3.226,7.208,7.224\n    C71.345,53.463,68.113,56.706,64.137,56.706z M64.137,45.604c-2.144,0-3.895,1.75-3.895,3.883c0,2.129,1.751,3.879,3.895,3.879\n    c2.139,0,3.884-1.75,3.884-3.879C68.021,47.354,66.275,45.604,64.137,45.604z M78.138,44.091c0-7.011-4.365-7.842-4.365-7.842\n    c-6.426-0.912-17.496-1.38-17.496-1.38c-1.016-1.766-5.707-12.039-8.44-12.039c-0.911,0-20.508,0-23.975,0\n    c-3.472,0-9.167,10.024-10.413,12.285c0,0-4.36,0.758-6.416,1.219c-1.142,0.265-4.301,0.324-4.301,9.155H0v3.997h6.654\n    c0-4.908,3.982-8.885,8.878-8.885c4.914,0,8.886,3.977,8.886,8.885h30.827c0-4.908,3.967-8.885,8.892-8.885\n    c4.898,0,8.875,3.977,8.875,8.885h6.524v-5.396H78.138z M35.589,34.191H21.751c1.872-5.831,5.339-9.994,6.801-9.994\n    c1.841,0,7.037,0,7.037,0V34.191z M38.168,34.191v-9.994c0,0,7.141,0,8.974,0c1.854,0,5.893,8.461,7.032,10.625L38.168,34.191z"/>\n</g>`,c=({id:t,color:e,isEngineStarted:n=!1})=>`\n  <div class="launch-pad">\n      <div class="control-panel">\n        <button class="start-button" id="start-car-${t}" ${n?"disabled":""}>\n          Start\n        </button>\n        <button class="stop-button" id="stop-car-${t}" ${n?"":"disabled"}>\n          Stop\n        </button>\n      </div>\n    </div>\n    <div class="distance-car">\n      <div class="car" id="car-${t}">\n        ${r(e)}\n      </div>\n    </div>\n    <div class="flag" id="flag-${t}">\n      &#127937\n    </div>\n`,i=({id:t,name:e,color:n})=>`\n  <div class="general-buttons">\n    <button class="button select-button" id="select-car-${t}">\n      Select\n    </button>\n    <button class="button remove-button" id="remove-car-${t}">\n      Remove\n    </button>\n    <span class="car-name">${e}</span>\n  </div>\n  <div class="road">\n    ${c({id:t,color:n})}\n  </div>\n`,d=()=>`\n  <h1>Garage (${s.h.carsCount})</h1>\n  <h2>Page #${s.h.carsPage}</h2>\n  <ul class="garage">\n    ${s.h.cars.map((t=>`\n      <li>${i(t)}</li>\n      `)).join("")}\n  </ul>\n  `,l=()=>`\n  <h1>Winners (${s.h.winnersCount})</h1>\n  <h2>Page (${s.h.winnersPage})</h2>\n  <table class="table" border="2">\n        <thead>\n          <th>Number</th>\n          <th>Car</th>\n          <th>Name</th>\n          <th class="button-sort table-wins ${"wins"===s.h.sortBy?s.h.sortOrder:""}" id="sort-by-wins">Wins</th>\n          <th class="button-sort table-time ${"time"===s.h.sortBy?s.h.sortOrder:""}" id="sort-by-time">Best time (s)</th>\n        </thead>\n        <tbody>\n          ${s.h.winners.map(((t,e)=>`\n          <tr>\n            <td>${e+1}</td>\n            <td>${r(t.car.color)}</td>\n            <td>${t.car.name}</td>\n            <td>${t.wins}</td>\n            <td>${t.time}</td>\n          </tr>\n          `)).join("")}\n        </tbody>\n  </table>\n`,u=()=>'\n  <div class="menu">\n    <button class="button button-view-garage" id="garage-menu">\n      To garage\n    </button>\n    <button class="button button-view-winners" id="winners-menu">\n      To winners\n    </button>\n  </div>',m=()=>'\n  <form class="form" id="create" autocomplete="off">\n    <input class="input" id="create-name" name="name" type="text">\n    <input class="color" id="create-color" name="color" type="color" value="#fede00">\n    <button class="button" type="submit">Create</button>\n  </form>\n  <form class="form" id="update" autocomplete="off">\n    <input class="input" id="update-name" name="name" type="text" disabled>\n    <input class="color" id="update-color" name="color" type="color" value="#fede00" disabled>\n    <button class="button update-submit" type="update-submit">Update</button>\n  </form>\n',h=()=>'\n  <button class="button race-button" id="race">Race</button>\n  <button class="button reset-button" id="reset" disabled>Reset</button>\n  <button class="button generator-button" id="generator">Generator cars</button>\n',w=()=>`\n  <div id="garage-view">\n    <p class="message" id="message"></p>\n    <div class="forms">\n      ${m()}\n    </div>\n    <div class="race-controls">\n      ${h()}\n    </div>\n    <div id="garage">\n      ${d()}\n    </div>\n  </div>\n`,y=()=>'\n  <button class="button button-prev" disabled id="prev">Prev</button>\n  <button class="button button-next" disabled id="next">Next</button>\n',p=async()=>{const t=`\n    ${u()}\n    <div class="pagination">\n      ${y()}\n    </div>\n    ${w()}\n    <div id="winners-view" style="display: none">\n      ${l()}\n    </div>\n  `,e=document.createElement("div");e.innerHTML=t,document.body.appendChild(e)};a()}catch(t){a(t)}}))},720:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{h:()=>i});var s=n(647);const{items:t,count:o}=await(0,s.Rn)(1),{items:r,count:c}=await(0,s.ix)({page:1}),i={carsPage:1,cars:t,carsCount:o,winnersPage:1,winners:r,winnersCount:c,animation:{},view:"garage",sortBy:"",sortOrder:""};a()}catch(t){a(t)}}),1)},22:(t,e,n)=>{function a(t){const{top:e,left:n,width:a,height:s}=t.getBoundingClientRect();return{x:n+a/2,y:e+s/2}}function s(t,e){const n=a(t),s=a(e);return Math.hypot(n.x-s.x,n.y-s.y)}function o(t,e,n){let a=0;const s={};return s.idAnim=window.requestAnimationFrame((function o(r){a||(a=r);const c=r-a,i=Math.round(c*(e/n));t.style.transform=`translateX(${Math.min(i,e)}px)`,i<e&&(s.idAnim=window.requestAnimationFrame(o))})),s}n.d(e,{SL:()=>l,Sp:()=>s,cj:()=>d,oQ:()=>o,rG:()=>u});const r=["Durango","Ram","Challenger","Charger","X7","X5","X3","C1","C3","Logan","Captur","Kadjar","RAV4","Rio","Creta","Solaris"],c=["Saab","Saipa","SEAT","Skoda","Subaru","Suzuki","Tata","Tesla","Torsus","Toyota","VinFast","Volkswagen","Volvo"],i=()=>{let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},d=(t=100)=>new Array(t).fill(1).map((()=>({name:`${r[Math.floor(Math.random()*r.length)]} ${c[Math.floor(Math.random()*c.length)]}`,color:i()}))),l=(t,e)=>{t.forEach((t=>document.querySelector(t).disabled=e))},u=(t,e)=>{t.forEach(((t,n)=>document.querySelector(t).style.display=e[n]))}},607:(t,e,n)=>{n.a(t,(async(t,e)=>{try{var a=n(34),s=n(545),o=n(182),r=t([a,s,o]);[a,s,o]=r.then?(await r)():r,(0,s.sY)(),await(0,o.g)(),(0,a.o)(),e()}catch(t){e(t)}}),1)}},o={};function r(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return s[t](n,n.exports,r),n.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",a=t=>{t&&!t.d&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},r.a=(s,o,r)=>{var c;r&&((c=[]).d=1);var i,d,l,u=new Set,m=s.exports,h=new Promise(((t,e)=>{l=e,d=t}));h[e]=m,h[t]=t=>(c&&t(c),u.forEach(t),h.catch((t=>{}))),s.exports=h,o((s=>{var o;i=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[t])return s;if(s.then){var o=[];o.d=0,s.then((t=>{r[e]=t,a(o)}),(t=>{r[n]=t,a(o)}));var r={};return r[t]=t=>t(o),r}}var c={};return c[t]=t=>{},c[e]=s,c})))(s);var r=()=>i.map((t=>{if(t[n])throw t[n];return t[e]})),d=new Promise((e=>{(o=()=>e(r)).r=0;var n=t=>t!==c&&!u.has(t)&&(u.add(t),t&&!t.d&&(o.r++,t.push(o)));i.map((e=>e[t](n)))}));return o.r?d:r()}),(t=>(t?l(h[n]=t):d(m),a(c)))),c&&(c.d=0)},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r(607)})();